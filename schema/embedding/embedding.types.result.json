{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://corpusos.com/schemas/embedding/embedding.types.result.json",
  "title": "Embedding Batch Result",
  "type": "object",
  "additionalProperties": false,
  "required": ["embeddings", "model", "total_texts"],
  "properties": {
    "embeddings": {
      "type": "array",
      "minItems": 0,
      "maxItems": 100000,
      "items": {
        "$ref": "https://corpusos.com/schemas/embedding/embedding.types.vector.json"
      }
    },
    "model": {
      "type": "string",
      "minLength": 1,
      "maxLength": 128
    },
    "total_texts": {
      "type": "integer",
      "minimum": 0
    },
    "total_tokens": {
      "type": "integer",
      "minimum": 0
    },
    "processed_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Total number of items processed (per ยง3.4 BatchResult pattern)."
    },
    "failed_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of items that failed (per ยง3.4 BatchResult pattern)."
    },
    "failed_texts": {
      "type": "array",
      "minItems": 0,
      "maxItems": 100000,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["index", "text", "error", "message"],
        "properties": {
          "index": {
            "type": "integer",
            "minimum": 0
          },
          "text": {
            "type": "string",
            "minLength": 1,
            "maxLength": 2000000
          },
          "error": {
            "type": "string",
            "maxLength": 128
          },
          "message": {
            "type": "string",
            "minLength": 1,
            "maxLength": 2000
          }
        }
      }
    },
    "failures": {
      "type": "array",
      "maxItems": 100000,
      "items": {
        "$ref": "https://corpusos.com/schemas/embedding/embedding.types.failure.json"
      }
    },
    "processing_time_ms": {
      "type": "number",
      "minimum": 0,
      "maximum": 86400000
    },
    "warnings": {
      "type": "array",
      "maxItems": 100,
      "items": {
        "$ref": "https://corpusos.com/schemas/embedding/embedding.types.warning.json"
      }
    }
  },
  "patternProperties": {
    "^(vendor:)[a-z0-9_.:-]+$": {
      "type": ["string", "number", "boolean", "object", "array", "null"]
    }
  },
  "$comment": "EmbedBatchResult per PROTOCOLS.md ยง18.4, with additional 'failures' for normalized error details and ยง3.4 BatchResult pattern fields. Invariants (semantic): embeddings.length + failed_texts.length == total_texts; processed_count == total_texts; failed_count == failures.length."
}
